{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ayush/Documents/GitHub/E-commerce/e-commerce/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/ayush/Documents/GitHub/E-commerce/e-commerce/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/ayush/Documents/GitHub/E-commerce/e-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,createContext,useContext,useReducer,useEffect}from\"react\";import{useLocation,useNavigate}from\"react-router-dom\";import{userDetails}from\"../services/getUser\";import{createUser}from\"../services/createUser\";import{initialUser,authReducerFun}from\"../reducers/authReducer\";import{setData}from\"../services/setLocal\";import{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/createContext();export var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var _useReducer=useReducer(authReducerFun,initialUser),_useReducer2=_slicedToArray(_useReducer,2),authState=_useReducer2[0],authDispatch=_useReducer2[1];var _useState=useState(localStorage.getItem(\"token\")?true:false),_useState2=_slicedToArray(_useState,2),isLogin=_useState2[0],setIsLogin=_useState2[1];useEffect(function(){authDispatch({type:\"LOAD_DATA\"});},[]);var location=useLocation();var navigate=useNavigate();var user=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(email,password){var response,encodedToken,_response$foundUser,firstName,lastName,_email,gender,phone,_response$foundUser$a,city,state,country,pin,_location$state;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return userDetails({email:email,password:password});case 3:response=_context.sent;if(!((response===null||response===void 0?void 0:response.encodedToken)===undefined)){_context.next=8;break;}throw response;case 8:encodedToken=response.encodedToken,_response$foundUser=response.foundUser,firstName=_response$foundUser.firstName,lastName=_response$foundUser.lastName,_email=_response$foundUser.email,gender=_response$foundUser.gender,phone=_response$foundUser.phone,_response$foundUser$a=_response$foundUser.address,city=_response$foundUser$a.city,state=_response$foundUser$a.state,country=_response$foundUser$a.country,pin=_response$foundUser$a.pin;setData(firstName,lastName,_email,gender,phone,city,state,country,pin,encodedToken);authDispatch({type:\"LOG_USER\",payload:{firstName:firstName,lastName:lastName,email:_email,gender:gender,phone:phone,address:{city:city,state:state,country:country,pin:pin},loginStatus:true}});case 11:if(localStorage.getItem(\"token\")){setIsLogin(true);navigate(location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.pathname);}_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 17:case\"end\":return _context.stop();}},_callee,null,[[0,14]]);}));return function user(_x,_x2){return _ref2.apply(this,arguments);};}();var signUp=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(newUser){var response,encodedToken,_response$createdUser,firstName,lastName,email,gender,phone,_response$createdUser2,city,state,country,pin,_location$state2;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:console.log(newUser);_context2.prev=1;_context2.next=4;return createUser(newUser);case 4:response=_context2.sent;if(!((response===null||response===void 0?void 0:response.encodedToken)===undefined)){_context2.next=9;break;}throw response;case 9:encodedToken=response.encodedToken,_response$createdUser=response.createdUser,firstName=_response$createdUser.firstName,lastName=_response$createdUser.lastName,email=_response$createdUser.email,gender=_response$createdUser.gender,phone=_response$createdUser.phone,_response$createdUser2=_response$createdUser.address,city=_response$createdUser2.city,state=_response$createdUser2.state,country=_response$createdUser2.country,pin=_response$createdUser2.pin;setData(firstName,lastName,email,gender,phone,city,state,country,pin,encodedToken);authDispatch({type:\"LOG_USER\",payload:{firstName:firstName,lastName:lastName,email:email,gender:gender,phone:phone,address:{city:city,state:state,country:country,pin:pin},loginStatus:true}});if(localStorage.getItem(\"token\")){setIsLogin(true);(location===null||location===void 0?void 0:location.state)===null?navigate(\"/\"):navigate(location===null||location===void 0?void 0:(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.pathname);}case 13:_context2.next=18;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 18:case\"end\":return _context2.stop();}},_callee2,null,[[1,15]]);}));return function signUp(_x3){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{isLogin:isLogin,setIsLogin:setIsLogin,authState:authState,authDispatch:authDispatch,user:user,signUp:signUp},children:children});};export var useAuth=function useAuth(){return useContext(AuthContext);};","map":{"version":3,"names":["useState","createContext","useContext","useReducer","useEffect","useLocation","useNavigate","userDetails","createUser","initialUser","authReducerFun","setData","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useReducer","_useReducer2","_slicedToArray","authState","authDispatch","_useState","localStorage","getItem","_useState2","isLogin","setIsLogin","type","location","navigate","user","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","email","password","response","encodedToken","_response$foundUser","firstName","lastName","_email","gender","phone","_response$foundUser$a","city","state","country","pin","_location$state","wrap","_callee$","_context","prev","next","sent","undefined","foundUser","address","payload","loginStatus","pathname","t0","console","log","stop","_x","_x2","apply","arguments","signUp","_ref3","_callee2","newUser","_response$createdUser","_response$createdUser2","_location$state2","_callee2$","_context2","createdUser","_x3","Provider","value","useAuth"],"sources":["C:/Users/ayush/Documents/GitHub/E-commerce/e-commerce/src/frontend/context/authContext.jsx"],"sourcesContent":["import {\r\n  useState,\r\n  createContext,\r\n  useContext,\r\n  useReducer,\r\n  useEffect,\r\n} from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { userDetails } from \"../services/getUser\";\r\nimport { createUser } from \"../services/createUser\";\r\nimport { initialUser, authReducerFun } from \"../reducers/authReducer\";\r\nimport { setData } from \"../services/setLocal\";\r\n\r\nexport const AuthContext = createContext();\r\nexport const AuthProvider = ({ children }) => {\r\n  const [authState, authDispatch] = useReducer(authReducerFun, initialUser);\r\n  const [isLogin, setIsLogin] = useState(\r\n    localStorage.getItem(\"token\") ? true : false\r\n  );\r\n  useEffect(() => {\r\n    authDispatch({ type: \"LOAD_DATA\" });\r\n  }, []);\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const user = async (email, password) => {\r\n    try {\r\n      const response = await userDetails({ email, password });\r\n      if (response?.encodedToken === undefined) throw response;\r\n      else {\r\n        const {\r\n          encodedToken,\r\n          foundUser: {\r\n            firstName,\r\n            lastName,\r\n            email,\r\n            gender,\r\n            phone,\r\n            address: { city, state, country, pin },\r\n          },\r\n        } = response;\r\n        setData(\r\n          firstName,\r\n          lastName,\r\n          email,\r\n          gender,\r\n          phone,\r\n          city,\r\n          state,\r\n          country,\r\n          pin,\r\n          encodedToken\r\n        );\r\n        authDispatch({\r\n          type: \"LOG_USER\",\r\n          payload: {\r\n            firstName,\r\n            lastName,\r\n            email,\r\n            gender,\r\n            phone,\r\n            address: { city, state, country, pin },\r\n            loginStatus: true,\r\n          },\r\n        });\r\n      }\r\n      if (localStorage.getItem(\"token\")) {\r\n        setIsLogin(true);\r\n        navigate(location?.state?.pathname);\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  };\r\n  const signUp = async (newUser) => {\r\n    console.log(newUser);\r\n    try {\r\n      const response = await createUser(newUser);\r\n      if (response?.encodedToken === undefined) throw response;\r\n      else {\r\n        const {\r\n          encodedToken,\r\n          createdUser: {\r\n            firstName,\r\n            lastName,\r\n            email,\r\n            gender,\r\n            phone,\r\n            address: { city, state, country, pin },\r\n          },\r\n        } = response;\r\n        setData(\r\n          firstName,\r\n          lastName,\r\n          email,\r\n          gender,\r\n          phone,\r\n          city,\r\n          state,\r\n          country,\r\n          pin,\r\n          encodedToken\r\n        );\r\n        authDispatch({\r\n          type: \"LOG_USER\",\r\n          payload: {\r\n            firstName,\r\n            lastName,\r\n            email,\r\n            gender,\r\n            phone,\r\n            address: { city, state, country, pin },\r\n            loginStatus: true,\r\n          },\r\n        });\r\n        if (localStorage.getItem(\"token\")) {\r\n          setIsLogin(true);\r\n          location?.state === null\r\n            ? navigate(\"/\")\r\n            : navigate(location?.state?.pathname);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  };\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{ isLogin, setIsLogin, authState, authDispatch, user, signUp }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\nexport const useAuth = () => useContext(AuthContext);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}