{"ast":null,"code":"import{Response}from\"miragejs\";import dayjs from\"dayjs\";import jwt_decode from\"jwt-decode\";export var requiresAuth=function requiresAuth(request){var encodedToken=request.requestHeaders.authorization;var decodedToken=jwt_decode(encodedToken,process.env.REACT_APP_JWT_SECRET);if(decodedToken){var user=this.db.users.findBy({email:decodedToken.email});if(user){return user._id;}}return new Response(401,{},{errors:[\"The token is invalid. Unauthorized access error.\"]});};export var formatDate=function formatDate(){return dayjs().format(\"YYYY-MM-DDTHH:mm:ssZ\");};","map":{"version":3,"names":["Response","dayjs","jwt_decode","requiresAuth","request","encodedToken","requestHeaders","authorization","decodedToken","process","env","REACT_APP_JWT_SECRET","user","db","users","findBy","email","_id","errors","formatDate","format"],"sources":["C:/Users/ayush/Documents/GitHub/E-commerce/e-commerce/src/backend/utils/authUtils.js"],"sourcesContent":["import { Response } from \"miragejs\";\r\nimport dayjs from \"dayjs\";\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nexport const requiresAuth = function (request) {\r\n  const encodedToken = request.requestHeaders.authorization;\r\n  const decodedToken = jwt_decode(\r\n    encodedToken,\r\n    process.env.REACT_APP_JWT_SECRET\r\n  );\r\n  if (decodedToken) {\r\n    const user = this.db.users.findBy({ email: decodedToken.email });\r\n    if (user) {\r\n      return user._id;\r\n    }\r\n  }\r\n  return new Response(\r\n    401,\r\n    {},\r\n    { errors: [\"The token is invalid. Unauthorized access error.\"] }\r\n  );\r\n};\r\n\r\nexport const formatDate = () => dayjs().format(\"YYYY-MM-DDTHH:mm:ssZ\");\r\n"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,UAAU,CACnC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,UAAU,KAAM,YAAY,CAEnC,MAAO,IAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAaC,OAAO,CAAE,CAC7C,GAAM,CAAAC,YAAY,CAAGD,OAAO,CAACE,cAAc,CAACC,aAAa,CACzD,GAAM,CAAAC,YAAY,CAAGN,UAAU,CAC7BG,YAAY,CACZI,OAAO,CAACC,GAAG,CAACC,oBACd,CAAC,CACD,GAAIH,YAAY,CAAE,CAChB,GAAM,CAAAI,IAAI,CAAG,IAAI,CAACC,EAAE,CAACC,KAAK,CAACC,MAAM,CAAC,CAAEC,KAAK,CAAER,YAAY,CAACQ,KAAM,CAAC,CAAC,CAChE,GAAIJ,IAAI,CAAE,CACR,MAAO,CAAAA,IAAI,CAACK,GAAG,CACjB,CACF,CACA,MAAO,IAAI,CAAAjB,QAAQ,CACjB,GAAG,CACH,CAAC,CAAC,CACF,CAAEkB,MAAM,CAAE,CAAC,kDAAkD,CAAE,CACjE,CAAC,CACH,CAAC,CAED,MAAO,IAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAA,QAAS,CAAAlB,KAAK,CAAC,CAAC,CAACmB,MAAM,CAAC,sBAAsB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}